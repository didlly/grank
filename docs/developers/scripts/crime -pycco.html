<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>crime.py</title>
  <link href="/grank/assets/img/favicon.png" rel="shortcut icon"/>
  <link href="/grank/assets/stylesheets/pycco.css" rel="stylesheet"/>
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>crime.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>

<span class="kn">from</span> <span class="nn">instance.Client</span> <span class="kn">import</span> <span class="n">Instance</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>The crime function is used to interact with the crime command.</p>
<p>Args:
Client (Instance): The Discord client</p>
<p>Returns:
bool: Indicates whether the command ran successfully or not</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">crime</span><span class="p">(</span><span class="n">Client</span><span class="p">:</span> <span class="n">Instance</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Send the command <code>pls crime</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">Client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;pls crime&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Get Dank Memer&rsquo;s response to <code>pls crime</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">latest_message</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">retreive_message</span><span class="p">(</span><span class="s2">&quot;pls crime&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>If the wrong latest message was retreived&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="s2">&quot;What crime do you want to commit&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>&hellip;get the correct latest message</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">latest_message</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">fallback_retreive_message</span><span class="p">(</span><span class="s2">&quot;pls crime&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>If the crime setting is random&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">Client</span><span class="o">.</span><span class="n">Repository</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;crime&quot;</span><span class="p">][</span><span class="s2">&quot;random&quot;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>&hellip;choose a random button to interact with</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">custom_id</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">])[</span><span class="s2">&quot;custom_id&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Else&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Get a list of all the possible places</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">places</span> <span class="o">=</span> <span class="p">[</span><span class="n">button</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;'&quot;</span>, <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">]]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Initialize custom_id as None</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">custom_id</span> <span class="o">=</span> <span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>For each key in the list of preferred crime places&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Client</span><span class="o">.</span><span class="n">Repository</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;crime&quot;</span><span class="p">][</span><span class="s2">&quot;preferences&quot;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>If the key is not enabled&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="n">Client</span><span class="o">.</span><span class="n">Repository</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;crime&quot;</span><span class="p">][</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>&hellip;continue to the next iteration of the for loop</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">continue</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>For each place that can be chosen&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">place</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">places</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>&hellip;if the key, in lowercase, is in the place that can be chosen&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">place</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Choose that place to interact with</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="n">custom_id</span> <span class="o">=</span> <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;custom_id&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Break out of the places for loop</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="k">break</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>If a button has been chosen&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>&hellip;break out of the keys for loop</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">break</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>If a button hasn&rsquo;t been chosen&hellip;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Choose a random button to interact with</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">custom_id</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;components&quot;</span><span class="p">])[</span><span class="s2">&quot;custom_id&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Interact with the button</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">Client</span><span class="o">.</span><span class="n">interact_button</span><span class="p">(</span>
        <span class="s2">&quot;pls crime&quot;</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">,</span>
        <span class="n">latest_message</span><span class="p">,</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Get Dank Memer&rsquo;s edited response</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">latest_message</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">retreive_message</span><span class="p">(</span>
        <span class="s2">&quot;pls crime&quot;</span><span class="p">,</span> <span class="n">old_latest_message</span><span class="o">=</span><span class="n">latest_message</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Remove the horseshoe emoji from Dank Memer&rsquo;s response</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span>
        <span class="s2">&quot;description&quot;</span>
    <span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &lt;:horseshoe:813911522975678476&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>Try and get the coins gained from the command</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">coins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span>
                    <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>If an Exception is raised, it will be caught here and the coins gained will be set to 0</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">coins</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">try</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Try and get the items gained from the command</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">latest_message</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="k">else</span> <span class="s2">&quot;no items&quot;</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>If an Exception is raised, it will be caught here and the items gained will be set to <code>no items</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;no items&quot;</span>

    <span class="n">Client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
        <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;Received </span><span class="si">{</span><span class="n">coins</span><span class="si">}</span><span class="s2"> coin</span><span class="si">{</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">coins</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;s&#39;</span><span class="si">}</span><span class="s2"> &amp;</span><span class="si">{</span><span class="s1">&#39; an&#39;</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;no items&#39;</span> <span class="k">else</span> <span class="s1">&#39; a&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> from the `pls crime` command.&quot;</span><span class="p">,</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Update the coins gained</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">Client</span><span class="o">.</span><span class="n">_update_coins</span><span class="p">(</span><span class="s2">&quot;pls crime&quot;</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Update the items gained</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">Client</span><span class="o">.</span><span class="n">_update_items</span><span class="p">(</span><span class="s2">&quot;pls crime&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
